---
phase: 08-server-identity-customization
task: 0
total_tasks: TBD (planning not yet run)
status: in_progress
last_updated: 2026-02-23T04:55:46.738Z
---

<current_state>
discuss-phase 8 just completed. CONTEXT.md was created and committed (commit 4dc0d8f).
No plans exist yet — /gsd:plan-phase 8 is the next action to take.
</current_state>

<completed_work>

- discuss-phase 8: Complete — CONTEXT.md created at .planning/phases/08-server-identity-customization/08-CONTEXT.md
  - All key decisions locked (default name, UUID derivation, config precedence, startup banner, compiler warnings)
- Phases 1–7: All complete and verified

</completed_work>

<remaining_work>

- Run /gsd:plan-phase 8 — research + planning not yet started
- Implement --name CLI flag (clap derive on Args struct)
- Add `name` key to FileConfig (TOML)
- Three-layer merge: CLI > TOML > default ("udlna@{hostname}" fallback "udlna")
- UUID v5 derivation from hostname only (uuid crate, Uuid::new_v5 with DNS namespace)
- Wire friendly name + UUID through device.xml and SSDP messages/headers
- Update startup banner to show: udlna "Shane uDLNA" (uuid: 9f27398b-...) on 192.168.4.111:8200
- Fix compiler warning: IfaceV4.index unused field (src/ssdp/socket.rs:63)
- Fix compiler warning: xml_escape lifetime Cow<str> → Cow<'_, str> (src/http/soap.rs:190)
- Zero compiler warnings must be the final state

</remaining_work>

<decisions_made>

- Default friendly name: "udlna@{hostname}" (e.g., "udlna@macbook"); fallback to "udlna" if hostname unavailable/generic
- UUID v5 derived from hostname ONLY — stable across --name changes; UUID changes only if hostname changes
- No need to warn users about UUID changes
- `name` settable in udlna.toml; precedence: CLI --name > TOML name > default
- Startup banner must show both name and UUID
- Both compiler warnings must be fixed as part of this phase

</decisions_made>

<blockers>

None — context is clear, no open questions.

</blockers>

<context>
Phase 8 is the final phase of milestone v1. It delivers:
1. Stable server identity (UUID v5 from hostname, no state file)
2. User-customizable friendly name (--name flag, TOML key) visible on TV/Xbox device lists
3. Zero compiler warnings (two existing warnings to fix)

The existing pattern to follow: three-layer config merge already exists for `port` — extend it for `name`. UUID currently uses `Uuid::new_v4()` in src/http/description.rs (from Phase 4) — replace with `Uuid::new_v5(&Uuid::NAMESPACE_DNS, hostname.as_bytes())`. The uuid crate already has the v4 feature; will need to add v5 feature.

SSDP messages (notify_alive, notify_byebye, msearch_response in src/ssdp/messages.rs) currently embed the UUID string. The friendly name goes into device.xml's <friendlyName> element (src/http/description.rs).
</context>

<next_action>
Run: /gsd:plan-phase 8

This will trigger research (codebase scan for UUID usage, config merge pattern, SSDP message signatures) then create 08-01-PLAN.md (likely 1 plan for this phase).
</next_action>
