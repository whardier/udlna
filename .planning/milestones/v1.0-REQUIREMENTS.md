# Requirements Archive: v1.0 MVP

**Archived:** 2026-02-23
**Status:** SHIPPED

For current requirements, see `.planning/REQUIREMENTS.md`.

---

# Requirements: udlna

**Defined:** 2026-02-22
**Core Value:** Any DLNA device on the local network — including Samsung TVs and Xbox Series X — can discover and play your media the moment you run `udlna /path/to/media`.

## v1 Requirements

Requirements for initial release. Each maps to a roadmap phase.

### Discovery (SSDP)

- [x] **DISC-01**: Server responds to SSDP M-SEARCH multicast with a unicast reply containing the correct LOCATION URL
- [x] **DISC-02**: Server sends SSDP NOTIFY alive on startup (sent 2-3 times for UDP reliability)
- [x] **DISC-03**: Server sends SSDP NOTIFY alive periodically (every 900 seconds) so clients that start after the server still discover it
- [x] **DISC-04**: Server sends SSDP NOTIFY byebye on Ctrl+C shutdown so clients remove it from their device lists
- [x] **DISC-05**: User can set a custom friendly server name via `--name` flag; name is shown on Samsung/Xbox device lists

### Device Description

- [x] **DESC-01**: Server serves UPnP device description XML at `/device.xml` with `MediaServer:1` device type, both service declarations, and `dlna:X_DLNADOC` element
- [x] **DESC-02**: Server serves ContentDirectory SCPD XML at `/cds/scpd.xml`
- [x] **DESC-03**: Server serves ConnectionManager SCPD XML at `/cms/scpd.xml`

### ContentDirectory Service

- [x] **CONT-01**: Server handles Browse (BrowseDirectChildren on root `ObjectID=0`) SOAP request and returns DIDL-Lite XML with all four required namespaces and correct element ordering
- [x] **CONT-02**: Server handles Browse (BrowseMetadata) SOAP request for individual item IDs
- [x] **CONT-03**: DIDL-Lite `<res>` elements include correct `protocolInfo` fourth field (DLNA.ORG_OP, DLNA.ORG_FLAGS) for each MIME type
- [x] **CONT-04**: Browse handles StartingIndex and RequestedCount pagination; RequestedCount=0 returns all items (per UPnP spec)
- [x] **CONT-05**: DIDL-Lite XML is correctly XML-escaped inside the SOAP `<Result>` element
- [x] **CONT-06**: Server handles GetSearchCapabilities SOAP request (stub returning empty search caps)
- [x] **CONT-07**: Server handles GetSortCapabilities SOAP request (stub returning empty sort caps)
- [x] **CONT-08**: Server handles GetSystemUpdateID SOAP request

### ConnectionManager Service

- [x] **CONN-01**: Server handles GetProtocolInfo SOAP request returning list of supported MIME types as source protocol infos
- [x] **CONN-02**: Server handles GetCurrentConnectionIDs SOAP request (stub returning "0")
- [x] **CONN-03**: Server handles GetCurrentConnectionInfo SOAP request (stub returning defaults)

### HTTP Media Streaming

- [x] **STRM-01**: Server serves video, audio, and image files via GET `/media/{id}` with correct MIME types detected from file extension
- [x] **STRM-02**: Server handles HEAD requests on `/media/{id}` endpoints (Samsung sends HEAD before every GET)
- [x] **STRM-03**: Server returns 206 Partial Content with correct `Content-Range: bytes start-end/total` header for Range requests (RFC 7233)
- [x] **STRM-04**: Server includes `Accept-Ranges: bytes` on all media responses
- [x] **STRM-05**: Server includes `contentFeatures.dlna.org` header with DLNA.ORG_OP=01 and DLNA.ORG_FLAGS on all media responses
- [x] **STRM-06**: Server includes `transferMode.dlna.org: Streaming` header on all media responses
- [x] **STRM-07**: DIDL-Lite `<res>` elements include `size` attribute (file size in bytes) to support Samsung seek position calculation

### Media Indexing

- [x] **INDX-01**: Server extracts media metadata at scan time by reading container/file headers (no transcoding, no ffmpeg dependency) — duration for audio/video, dimensions for video/images, bitrate where available
- [x] **INDX-02**: DIDL-Lite `<res>` elements include `duration` attribute (UPnP format: `HH:MM:SS.mmm`) for audio and video files
- [x] **INDX-03**: DIDL-Lite `<res>` elements include `resolution` attribute (`WxH`) for video files and images
- [x] **INDX-04**: DIDL-Lite `<res protocolInfo>` uses media-format-aware DLNA profile names where determinable from container/codec metadata; falls back to wildcard for unrecognized formats

### CLI & Configuration

- [x] **CLI-01**: User passes one or more media directory paths as positional CLI arguments (`udlna /path1 /path2 ...`)
- [x] **CLI-02**: Server recursively scans all provided paths at startup and exposes all files as a flat list
- [x] **CLI-03**: Server detects MIME type for video, audio, and image files from file extension; non-media files are silently skipped
- [x] **CLI-04**: User can load configuration from an optional TOML config file searched at `./udlna.toml` then `~/.config/udlna/config.toml`
- [x] **CLI-05**: CLI flags override config file values; all settings have sensible defaults requiring zero configuration
- [x] **CLI-06**: Server runs until Ctrl+C; shutdown is graceful (SSDP byebye before exit)
- [x] **CLI-07**: User can set HTTP listening port via `--port` flag (default: 8200)
- [x] **CLI-08**: Server uses a stable UUID v5 derived from hostname + server name using the DNS namespace UUID (RFC 4122); consistent across restarts without requiring persistent state

## v2 Requirements

Deferred to future release. Tracked but not in current roadmap.

### Content Browsing

- **BROW-01**: Hierarchical directory browsing — expose folder structure as UPnP containers
- **BROW-02**: Multiple root paths exposed as separate top-level UPnP containers

### Media Enhancements

- **MENH-01**: Subtitle file association — serve `.srt`/`.sub` files alongside videos for Samsung external subtitle support
- **MENH-02**: Thumbnail serving — album art and video stills (requires image processing)

### Operational

- **OPER-01**: SIGHUP triggers rescan without restarting the server

## Out of Scope

Explicitly excluded. Documented to prevent scope creep.

| Feature | Reason |
|---------|--------|
| Transcoding | Conflicts with single-binary, zero-dependency goal; users needing transcoding should use Plex/Jellyfin |
| Media metadata database | Conflicts with ephemeral on-demand operation; filesystem scan at startup is the model |
| Web UI / management interface | Different product category; this is a CLI tool |
| Authentication / access control | Local network trust model; adds complexity with no value for the use case |
| Running as a system daemon / service | On-demand only; that's the core differentiator from MiniDLNA |
| IPv6 SSDP multicast (ff02::c) | Dual-stack SSDP implemented in Phase 6 per user decision; IPv6 HTTP already exists |
| UPnP eventing (SUBSCRIBE/NOTIFY) | Not required by Samsung TV or Xbox for browse + play |
| ContentDirectory Search action | Requires metadata indexing; flat list + Browse is sufficient for v1 |

## Traceability

Which phases cover which requirements. Updated during roadmap creation.

| Requirement | Phase | Status |
|-------------|-------|--------|
| CLI-01 | Phase 1 | Complete |
| CLI-02 | Phase 2 | Complete |
| CLI-03 | Phase 1 | Complete |
| CLI-04 | Phase 1 | Complete |
| CLI-05 | Phase 1 | Complete |
| CLI-06 | Phase 6 | Complete |
| CLI-07 | Phase 1 | Complete |
| CLI-08 | Phase 8 | Complete |
| DESC-01 | Phase 4 | Complete |
| DESC-02 | Phase 4 | Complete |
| DESC-03 | Phase 4 | Complete |
| DISC-01 | Phase 6 | Complete |
| DISC-02 | Phase 6 | Complete |
| DISC-03 | Phase 6 | Complete |
| DISC-04 | Phase 6 | Complete |
| DISC-05 | Phase 8 | Complete |
| CONT-01 | Phase 5 | Complete |
| CONT-02 | Phase 5 | Complete |
| CONT-03 | Phase 5 | Complete |
| CONT-04 | Phase 5 | Complete |
| CONT-05 | Phase 5 | Complete |
| CONT-06 | Phase 5 | Complete |
| CONT-07 | Phase 5 | Complete |
| CONT-08 | Phase 5 | Complete |
| CONN-01 | Phase 7 | Complete |
| CONN-02 | Phase 7 | Complete |
| CONN-03 | Phase 7 | Complete |
| STRM-01 | Phase 3 | Complete |
| STRM-02 | Phase 3 | Complete |
| STRM-03 | Phase 3 | Complete |
| STRM-04 | Phase 3 | Complete |
| STRM-05 | Phase 3 | Complete |
| STRM-06 | Phase 3 | Complete |
| STRM-07 | Phase 3 | Complete |
| INDX-01 | Phase 2 | Complete |
| INDX-02 | Phase 2 | Complete |
| INDX-03 | Phase 2 | Complete |
| INDX-04 | Phase 2 | Complete |

**Coverage:**
- v1 requirements: 38 total
- Mapped to phases: 38
- Unmapped: 0

---
*Requirements defined: 2026-02-22*
*Last updated: 2026-02-22 after roadmap creation*
